<html>
<head>
<title>basededato.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cf8e6d;}
.s1 { color: #bcbec4;}
.s2 { color: #bcbec4;}
.s3 { color: #6aab73;}
.s4 { color: #7a7e85;}
.s5 { color: #2aacb8;}
.s6 { color: #5f826b; font-style: italic;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
basededato.py</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">tkinter </span><span class="s0">as </span><span class="s1">tk</span>
<span class="s0">from </span><span class="s1">tkinter </span><span class="s0">import </span><span class="s1">ttk</span><span class="s2">, </span><span class="s1">messagebox</span>
<span class="s0">import </span><span class="s1">mysql</span><span class="s2">.</span><span class="s1">connector</span>
<span class="s0">from </span><span class="s1">datetime </span><span class="s0">import </span><span class="s1">datetime</span>


<span class="s0">class </span><span class="s1">EventosApp</span><span class="s2">:</span>
    <span class="s0">def </span><span class="s1">__init__</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">root</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">root </span><span class="s2">= </span><span class="s1">root</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">root</span><span class="s2">.</span><span class="s1">title</span><span class="s2">(</span><span class="s3">&quot;Sistema de Gestión de Eventos (Modo Temporal)&quot;</span><span class="s2">)</span>

        <span class="s4"># Configuración de la conexión con autocommit=False para manejar transacciones</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">conexion </span><span class="s2">= </span><span class="s1">mysql</span><span class="s2">.</span><span class="s1">connector</span><span class="s2">.</span><span class="s1">connect</span><span class="s2">(</span>
            <span class="s1">host</span><span class="s2">=</span><span class="s3">&quot;localhost&quot;</span><span class="s2">,</span>
            <span class="s1">user</span><span class="s2">=</span><span class="s3">&quot;root&quot;</span><span class="s2">,</span>
            <span class="s1">password</span><span class="s2">=</span><span class="s3">&quot;sucontraseña &gt;:c&quot;</span><span class="s2">, </span><span class="s4">#la contraseña de uds</span>
            <span class="s1">database</span><span class="s2">=</span><span class="s3">&quot;g07&quot;</span><span class="s2">,</span>
            <span class="s1">autocommit</span><span class="s2">=</span><span class="s0">False</span>
        <span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">cursor </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">conexion</span><span class="s2">.</span><span class="s1">cursor</span><span class="s2">()</span>

        <span class="s4"># Iniciar transacción</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">cursor</span><span class="s2">.</span><span class="s1">execute</span><span class="s2">(</span><span class="s3">&quot;START TRANSACTION&quot;</span><span class="s2">)</span>

        <span class="s4"># Frame principal</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">frame </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Frame</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">root</span><span class="s2">, </span><span class="s1">padding</span><span class="s2">=</span><span class="s3">&quot;10&quot;</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">frame</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=(</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">W</span><span class="s2">, </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">E</span><span class="s2">, </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">N</span><span class="s2">, </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">S</span><span class="s2">))</span>

        <span class="s4"># Variables para los campos</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">codigo_var </span><span class="s2">= </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">StringVar</span><span class="s2">()</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">fecha_var </span><span class="s2">= </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">StringVar</span><span class="s2">()</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">ubicacion_var </span><span class="s2">= </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">StringVar</span><span class="s2">()</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">tematica_var </span><span class="s2">= </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">StringVar</span><span class="s2">()</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">descripcion_var </span><span class="s2">= </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">StringVar</span><span class="s2">()</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">valor_var </span><span class="s2">= </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">StringVar</span><span class="s2">()</span>

        <span class="s4"># Crear campos de entrada</span>
        <span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">frame</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Código:&quot;</span><span class="s2">).</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">W</span><span class="s2">)</span>
        <span class="s1">ttk</span><span class="s2">.</span><span class="s1">Entry</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">frame</span><span class="s2">, </span><span class="s1">textvariable</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">codigo_var</span><span class="s2">).</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s5">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s5">5</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s5">5</span><span class="s2">)</span>

        <span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">frame</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Fecha (YYYY-MM-DD):&quot;</span><span class="s2">).</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s5">1</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">W</span><span class="s2">)</span>
        <span class="s1">ttk</span><span class="s2">.</span><span class="s1">Entry</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">frame</span><span class="s2">, </span><span class="s1">textvariable</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">fecha_var</span><span class="s2">).</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s5">1</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s5">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s5">5</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s5">5</span><span class="s2">)</span>

        <span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">frame</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Ubicación:&quot;</span><span class="s2">).</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s5">2</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">W</span><span class="s2">)</span>
        <span class="s1">ttk</span><span class="s2">.</span><span class="s1">Entry</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">frame</span><span class="s2">, </span><span class="s1">textvariable</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">ubicacion_var</span><span class="s2">).</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s5">2</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s5">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s5">5</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s5">5</span><span class="s2">)</span>

        <span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">frame</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Temática:&quot;</span><span class="s2">).</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s5">3</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">W</span><span class="s2">)</span>
        <span class="s1">ttk</span><span class="s2">.</span><span class="s1">Entry</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">frame</span><span class="s2">, </span><span class="s1">textvariable</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">tematica_var</span><span class="s2">).</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s5">3</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s5">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s5">5</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s5">5</span><span class="s2">)</span>

        <span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">frame</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Descripción:&quot;</span><span class="s2">).</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s5">4</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">W</span><span class="s2">)</span>
        <span class="s1">ttk</span><span class="s2">.</span><span class="s1">Entry</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">frame</span><span class="s2">, </span><span class="s1">textvariable</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">descripcion_var</span><span class="s2">).</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s5">4</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s5">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s5">5</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s5">5</span><span class="s2">)</span>

        <span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">frame</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Valor Total:&quot;</span><span class="s2">).</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s5">5</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">W</span><span class="s2">)</span>
        <span class="s1">ttk</span><span class="s2">.</span><span class="s1">Entry</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">frame</span><span class="s2">, </span><span class="s1">textvariable</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">valor_var</span><span class="s2">).</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s5">5</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s5">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s5">5</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s5">5</span><span class="s2">)</span>

        <span class="s4"># Botones CRUD</span>
        <span class="s1">ttk</span><span class="s2">.</span><span class="s1">Button</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">frame</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Crear&quot;</span><span class="s2">, </span><span class="s1">command</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">crear_evento</span><span class="s2">).</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s5">6</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s5">10</span><span class="s2">)</span>
        <span class="s1">ttk</span><span class="s2">.</span><span class="s1">Button</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">frame</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Buscar&quot;</span><span class="s2">, </span><span class="s1">command</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">buscar_evento</span><span class="s2">).</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s5">6</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s5">1</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s5">10</span><span class="s2">)</span>
        <span class="s1">ttk</span><span class="s2">.</span><span class="s1">Button</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">frame</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Actualizar&quot;</span><span class="s2">, </span><span class="s1">command</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">actualizar_evento</span><span class="s2">).</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s5">6</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s5">2</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s5">10</span><span class="s2">)</span>
        <span class="s1">ttk</span><span class="s2">.</span><span class="s1">Button</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">frame</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Eliminar&quot;</span><span class="s2">, </span><span class="s1">command</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">eliminar_evento</span><span class="s2">).</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s5">6</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s5">3</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s5">10</span><span class="s2">)</span>

        <span class="s4"># Botones de control de transacción</span>
        <span class="s1">ttk</span><span class="s2">.</span><span class="s1">Button</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">frame</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Guardar Cambios&quot;</span><span class="s2">, </span><span class="s1">command</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">commit_cambios</span><span class="s2">,</span>
                   <span class="s1">style</span><span class="s2">=</span><span class="s3">'Accent.TButton'</span><span class="s2">).</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s5">7</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">columnspan</span><span class="s2">=</span><span class="s5">2</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s5">10</span><span class="s2">)</span>
        <span class="s1">ttk</span><span class="s2">.</span><span class="s1">Button</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">frame</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Descartar Cambios&quot;</span><span class="s2">, </span><span class="s1">command</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">descartar_cambios</span><span class="s2">,</span>
                   <span class="s1">style</span><span class="s2">=</span><span class="s3">'Accent.TButton'</span><span class="s2">).</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s5">7</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s5">2</span><span class="s2">, </span><span class="s1">columnspan</span><span class="s2">=</span><span class="s5">2</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s5">10</span><span class="s2">)</span>

        <span class="s4"># Tabla de eventos</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">tree </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Treeview</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">frame</span><span class="s2">,</span>
                                 <span class="s1">columns</span><span class="s2">=(</span><span class="s3">&quot;Código&quot;</span><span class="s2">, </span><span class="s3">&quot;Fecha&quot;</span><span class="s2">, </span><span class="s3">&quot;Ubicación&quot;</span><span class="s2">, </span><span class="s3">&quot;Temática&quot;</span><span class="s2">, </span><span class="s3">&quot;Descripción&quot;</span><span class="s2">, </span><span class="s3">&quot;Valor&quot;</span><span class="s2">),</span>
                                 <span class="s1">show</span><span class="s2">=</span><span class="s3">&quot;headings&quot;</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">tree</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s5">8</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">columnspan</span><span class="s2">=</span><span class="s5">4</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s5">10</span><span class="s2">)</span>

        <span class="s4"># Configurar columnas</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">tree</span><span class="s2">.</span><span class="s1">heading</span><span class="s2">(</span><span class="s3">&quot;Código&quot;</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Código&quot;</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">tree</span><span class="s2">.</span><span class="s1">heading</span><span class="s2">(</span><span class="s3">&quot;Fecha&quot;</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Fecha&quot;</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">tree</span><span class="s2">.</span><span class="s1">heading</span><span class="s2">(</span><span class="s3">&quot;Ubicación&quot;</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Ubicación&quot;</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">tree</span><span class="s2">.</span><span class="s1">heading</span><span class="s2">(</span><span class="s3">&quot;Temática&quot;</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Temática&quot;</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">tree</span><span class="s2">.</span><span class="s1">heading</span><span class="s2">(</span><span class="s3">&quot;Descripción&quot;</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Descripción&quot;</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">tree</span><span class="s2">.</span><span class="s1">heading</span><span class="s2">(</span><span class="s3">&quot;Valor&quot;</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Valor Total&quot;</span><span class="s2">)</span>

        <span class="s4"># Etiqueta de modo temporal</span>
        <span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">frame</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;MODO TEMPORAL - Los cambios no se guardarán hasta que presiones 'Guardar Cambios'&quot;</span><span class="s2">,</span>
                  <span class="s1">foreground</span><span class="s2">=</span><span class="s3">'red'</span><span class="s2">).</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s5">9</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">columnspan</span><span class="s2">=</span><span class="s5">4</span><span class="s2">)</span>

        <span class="s4"># Cargar datos iniciales</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">actualizar_tabla</span><span class="s2">()</span>

        <span class="s4"># Bind para selección en la tabla</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">tree</span><span class="s2">.</span><span class="s1">bind</span><span class="s2">(</span><span class="s3">'&lt;&lt;TreeviewSelect&gt;&gt;'</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">item_seleccionado</span><span class="s2">)</span>

        <span class="s4"># Bind para el cierre de la ventana</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">root</span><span class="s2">.</span><span class="s1">protocol</span><span class="s2">(</span><span class="s3">&quot;WM_DELETE_WINDOW&quot;</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">on_closing</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">on_closing</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s6">&quot;&quot;&quot;Maneja el cierre de la ventana&quot;&quot;&quot;</span>
        <span class="s0">if </span><span class="s1">messagebox</span><span class="s2">.</span><span class="s1">askyesno</span><span class="s2">(</span><span class="s3">&quot;Confirmar&quot;</span><span class="s2">, </span><span class="s3">&quot;¿Deseas guardar los cambios antes de salir?&quot;</span><span class="s2">):</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">commit_cambios</span><span class="s2">()</span>
        <span class="s0">else</span><span class="s2">:</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">descartar_cambios</span><span class="s2">()</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">root</span><span class="s2">.</span><span class="s1">destroy</span><span class="s2">()</span>

    <span class="s0">def </span><span class="s1">commit_cambios</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s6">&quot;&quot;&quot;Guarda los cambios en la base de datos&quot;&quot;&quot;</span>
        <span class="s0">try</span><span class="s2">:</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">conexion</span><span class="s2">.</span><span class="s1">commit</span><span class="s2">()</span>
            <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showinfo</span><span class="s2">(</span><span class="s3">&quot;Éxito&quot;</span><span class="s2">, </span><span class="s3">&quot;Cambios guardados correctamente&quot;</span><span class="s2">)</span>
        <span class="s0">except </span><span class="s1">mysql</span><span class="s2">.</span><span class="s1">connector</span><span class="s2">.</span><span class="s1">Error </span><span class="s0">as </span><span class="s1">err</span><span class="s2">:</span>
            <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showerror</span><span class="s2">(</span><span class="s3">&quot;Error&quot;</span><span class="s2">, </span><span class="s3">f&quot;Error al guardar cambios: </span><span class="s0">{</span><span class="s1">err</span><span class="s0">}</span><span class="s3">&quot;</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">descartar_cambios</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s6">&quot;&quot;&quot;Descarta todos los cambios realizados&quot;&quot;&quot;</span>
        <span class="s0">try</span><span class="s2">:</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">conexion</span><span class="s2">.</span><span class="s1">rollback</span><span class="s2">()</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">actualizar_tabla</span><span class="s2">()</span>
            <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showinfo</span><span class="s2">(</span><span class="s3">&quot;Éxito&quot;</span><span class="s2">, </span><span class="s3">&quot;Cambios descartados&quot;</span><span class="s2">)</span>
        <span class="s0">except </span><span class="s1">mysql</span><span class="s2">.</span><span class="s1">connector</span><span class="s2">.</span><span class="s1">Error </span><span class="s0">as </span><span class="s1">err</span><span class="s2">:</span>
            <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showerror</span><span class="s2">(</span><span class="s3">&quot;Error&quot;</span><span class="s2">, </span><span class="s3">f&quot;Error al descartar cambios: </span><span class="s0">{</span><span class="s1">err</span><span class="s0">}</span><span class="s3">&quot;</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">limpiar_campos</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">codigo_var</span><span class="s2">.</span><span class="s1">set</span><span class="s2">(</span><span class="s3">&quot;&quot;</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">fecha_var</span><span class="s2">.</span><span class="s1">set</span><span class="s2">(</span><span class="s3">&quot;&quot;</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">ubicacion_var</span><span class="s2">.</span><span class="s1">set</span><span class="s2">(</span><span class="s3">&quot;&quot;</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">tematica_var</span><span class="s2">.</span><span class="s1">set</span><span class="s2">(</span><span class="s3">&quot;&quot;</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">descripcion_var</span><span class="s2">.</span><span class="s1">set</span><span class="s2">(</span><span class="s3">&quot;&quot;</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">valor_var</span><span class="s2">.</span><span class="s1">set</span><span class="s2">(</span><span class="s3">&quot;&quot;</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">actualizar_tabla</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4"># Limpiar tabla</span>
        <span class="s0">for </span><span class="s1">item </span><span class="s0">in </span><span class="s1">self</span><span class="s2">.</span><span class="s1">tree</span><span class="s2">.</span><span class="s1">get_children</span><span class="s2">():</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">tree</span><span class="s2">.</span><span class="s1">delete</span><span class="s2">(</span><span class="s1">item</span><span class="s2">)</span>

        <span class="s4"># Obtener y mostrar datos</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">cursor</span><span class="s2">.</span><span class="s1">execute</span><span class="s2">(</span><span class="s3">&quot;SELECT * FROM Evento&quot;</span><span class="s2">)</span>
        <span class="s0">for </span><span class="s1">evento </span><span class="s0">in </span><span class="s1">self</span><span class="s2">.</span><span class="s1">cursor</span><span class="s2">.</span><span class="s1">fetchall</span><span class="s2">():</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">tree</span><span class="s2">.</span><span class="s1">insert</span><span class="s2">(</span><span class="s3">&quot;&quot;</span><span class="s2">, </span><span class="s3">&quot;end&quot;</span><span class="s2">, </span><span class="s1">values</span><span class="s2">=</span><span class="s1">evento</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">crear_evento</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">try</span><span class="s2">:</span>
            <span class="s1">sql </span><span class="s2">= </span><span class="s3">&quot;&quot;&quot;INSERT INTO Evento (codigo, fecha, ubicacion, tematica, descripcion, valorTotal)  
                     VALUES (%s, %s, %s, %s, %s, %s)&quot;&quot;&quot;</span>
            <span class="s1">valores </span><span class="s2">= (</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">codigo_var</span><span class="s2">.</span><span class="s1">get</span><span class="s2">(),</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">fecha_var</span><span class="s2">.</span><span class="s1">get</span><span class="s2">(),</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">ubicacion_var</span><span class="s2">.</span><span class="s1">get</span><span class="s2">(),</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">tematica_var</span><span class="s2">.</span><span class="s1">get</span><span class="s2">(),</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">descripcion_var</span><span class="s2">.</span><span class="s1">get</span><span class="s2">(),</span>
                <span class="s1">float</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">valor_var</span><span class="s2">.</span><span class="s1">get</span><span class="s2">())</span>
            <span class="s2">)</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">cursor</span><span class="s2">.</span><span class="s1">execute</span><span class="s2">(</span><span class="s1">sql</span><span class="s2">, </span><span class="s1">valores</span><span class="s2">)</span>
            <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showinfo</span><span class="s2">(</span><span class="s3">&quot;Éxito&quot;</span><span class="s2">, </span><span class="s3">&quot;Evento creado (pendiente de guardar)&quot;</span><span class="s2">)</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">limpiar_campos</span><span class="s2">()</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">actualizar_tabla</span><span class="s2">()</span>
        <span class="s0">except </span><span class="s1">mysql</span><span class="s2">.</span><span class="s1">connector</span><span class="s2">.</span><span class="s1">Error </span><span class="s0">as </span><span class="s1">err</span><span class="s2">:</span>
            <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showerror</span><span class="s2">(</span><span class="s3">&quot;Error&quot;</span><span class="s2">, </span><span class="s3">f&quot;Error al crear evento: </span><span class="s0">{</span><span class="s1">err</span><span class="s0">}</span><span class="s3">&quot;</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">buscar_evento</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">codigo </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">codigo_var</span><span class="s2">.</span><span class="s1">get</span><span class="s2">()</span>
        <span class="s0">try</span><span class="s2">:</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">cursor</span><span class="s2">.</span><span class="s1">execute</span><span class="s2">(</span><span class="s3">&quot;SELECT * FROM Evento WHERE codigo = %s&quot;</span><span class="s2">, (</span><span class="s1">codigo</span><span class="s2">,))</span>
            <span class="s1">evento </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">cursor</span><span class="s2">.</span><span class="s1">fetchone</span><span class="s2">()</span>
            <span class="s0">if </span><span class="s1">evento</span><span class="s2">:</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">codigo_var</span><span class="s2">.</span><span class="s1">set</span><span class="s2">(</span><span class="s1">evento</span><span class="s2">[</span><span class="s5">0</span><span class="s2">])</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">fecha_var</span><span class="s2">.</span><span class="s1">set</span><span class="s2">(</span><span class="s1">evento</span><span class="s2">[</span><span class="s5">1</span><span class="s2">])</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">ubicacion_var</span><span class="s2">.</span><span class="s1">set</span><span class="s2">(</span><span class="s1">evento</span><span class="s2">[</span><span class="s5">2</span><span class="s2">])</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">tematica_var</span><span class="s2">.</span><span class="s1">set</span><span class="s2">(</span><span class="s1">evento</span><span class="s2">[</span><span class="s5">3</span><span class="s2">])</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">descripcion_var</span><span class="s2">.</span><span class="s1">set</span><span class="s2">(</span><span class="s1">evento</span><span class="s2">[</span><span class="s5">4</span><span class="s2">])</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">valor_var</span><span class="s2">.</span><span class="s1">set</span><span class="s2">(</span><span class="s1">evento</span><span class="s2">[</span><span class="s5">5</span><span class="s2">])</span>
            <span class="s0">else</span><span class="s2">:</span>
                <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showinfo</span><span class="s2">(</span><span class="s3">&quot;Búsqueda&quot;</span><span class="s2">, </span><span class="s3">&quot;No se encontró el evento&quot;</span><span class="s2">)</span>
        <span class="s0">except </span><span class="s1">mysql</span><span class="s2">.</span><span class="s1">connector</span><span class="s2">.</span><span class="s1">Error </span><span class="s0">as </span><span class="s1">err</span><span class="s2">:</span>
            <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showerror</span><span class="s2">(</span><span class="s3">&quot;Error&quot;</span><span class="s2">, </span><span class="s3">f&quot;Error al buscar evento: </span><span class="s0">{</span><span class="s1">err</span><span class="s0">}</span><span class="s3">&quot;</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">actualizar_evento</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">try</span><span class="s2">:</span>
            <span class="s1">sql </span><span class="s2">= </span><span class="s3">&quot;&quot;&quot;UPDATE Evento SET fecha = %s, ubicacion = %s, tematica = %s,  
                     descripcion = %s, valorTotal = %s WHERE codigo = %s&quot;&quot;&quot;</span>
            <span class="s1">valores </span><span class="s2">= (</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">fecha_var</span><span class="s2">.</span><span class="s1">get</span><span class="s2">(),</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">ubicacion_var</span><span class="s2">.</span><span class="s1">get</span><span class="s2">(),</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">tematica_var</span><span class="s2">.</span><span class="s1">get</span><span class="s2">(),</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">descripcion_var</span><span class="s2">.</span><span class="s1">get</span><span class="s2">(),</span>
                <span class="s1">float</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">valor_var</span><span class="s2">.</span><span class="s1">get</span><span class="s2">()),</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">codigo_var</span><span class="s2">.</span><span class="s1">get</span><span class="s2">()</span>
            <span class="s2">)</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">cursor</span><span class="s2">.</span><span class="s1">execute</span><span class="s2">(</span><span class="s1">sql</span><span class="s2">, </span><span class="s1">valores</span><span class="s2">)</span>
            <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showinfo</span><span class="s2">(</span><span class="s3">&quot;Éxito&quot;</span><span class="s2">, </span><span class="s3">&quot;Evento actualizado (pendiente de guardar)&quot;</span><span class="s2">)</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">actualizar_tabla</span><span class="s2">()</span>
        <span class="s0">except </span><span class="s1">mysql</span><span class="s2">.</span><span class="s1">connector</span><span class="s2">.</span><span class="s1">Error </span><span class="s0">as </span><span class="s1">err</span><span class="s2">:</span>
            <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showerror</span><span class="s2">(</span><span class="s3">&quot;Error&quot;</span><span class="s2">, </span><span class="s3">f&quot;Error al actualizar evento: </span><span class="s0">{</span><span class="s1">err</span><span class="s0">}</span><span class="s3">&quot;</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">eliminar_evento</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">if </span><span class="s1">messagebox</span><span class="s2">.</span><span class="s1">askyesno</span><span class="s2">(</span><span class="s3">&quot;Confirmar&quot;</span><span class="s2">, </span><span class="s3">&quot;¿Está seguro de eliminar este evento?&quot;</span><span class="s2">):</span>
            <span class="s0">try</span><span class="s2">:</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">cursor</span><span class="s2">.</span><span class="s1">execute</span><span class="s2">(</span><span class="s3">&quot;DELETE FROM Evento WHERE codigo = %s&quot;</span><span class="s2">, (</span><span class="s1">self</span><span class="s2">.</span><span class="s1">codigo_var</span><span class="s2">.</span><span class="s1">get</span><span class="s2">(),))</span>
                <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showinfo</span><span class="s2">(</span><span class="s3">&quot;Éxito&quot;</span><span class="s2">, </span><span class="s3">&quot;Evento eliminado (pendiente de guardar)&quot;</span><span class="s2">)</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">limpiar_campos</span><span class="s2">()</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">actualizar_tabla</span><span class="s2">()</span>
            <span class="s0">except </span><span class="s1">mysql</span><span class="s2">.</span><span class="s1">connector</span><span class="s2">.</span><span class="s1">Error </span><span class="s0">as </span><span class="s1">err</span><span class="s2">:</span>
                <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showerror</span><span class="s2">(</span><span class="s3">&quot;Error&quot;</span><span class="s2">, </span><span class="s3">f&quot;Error al eliminar evento: </span><span class="s0">{</span><span class="s1">err</span><span class="s0">}</span><span class="s3">&quot;</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">item_seleccionado</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">event</span><span class="s2">):</span>
        <span class="s1">seleccion </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">tree</span><span class="s2">.</span><span class="s1">selection</span><span class="s2">()</span>
        <span class="s0">if </span><span class="s1">seleccion</span><span class="s2">:</span>
            <span class="s1">item </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">tree</span><span class="s2">.</span><span class="s1">item</span><span class="s2">(</span><span class="s1">seleccion</span><span class="s2">[</span><span class="s5">0</span><span class="s2">])</span>
            <span class="s1">valores </span><span class="s2">= </span><span class="s1">item</span><span class="s2">[</span><span class="s3">'values'</span><span class="s2">]</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">codigo_var</span><span class="s2">.</span><span class="s1">set</span><span class="s2">(</span><span class="s1">valores</span><span class="s2">[</span><span class="s5">0</span><span class="s2">])</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">fecha_var</span><span class="s2">.</span><span class="s1">set</span><span class="s2">(</span><span class="s1">valores</span><span class="s2">[</span><span class="s5">1</span><span class="s2">])</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">ubicacion_var</span><span class="s2">.</span><span class="s1">set</span><span class="s2">(</span><span class="s1">valores</span><span class="s2">[</span><span class="s5">2</span><span class="s2">])</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">tematica_var</span><span class="s2">.</span><span class="s1">set</span><span class="s2">(</span><span class="s1">valores</span><span class="s2">[</span><span class="s5">3</span><span class="s2">])</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">descripcion_var</span><span class="s2">.</span><span class="s1">set</span><span class="s2">(</span><span class="s1">valores</span><span class="s2">[</span><span class="s5">4</span><span class="s2">])</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">valor_var</span><span class="s2">.</span><span class="s1">set</span><span class="s2">(</span><span class="s1">valores</span><span class="s2">[</span><span class="s5">5</span><span class="s2">])</span>


<span class="s0">if </span><span class="s1">__name__ </span><span class="s2">== </span><span class="s3">&quot;__main__&quot;</span><span class="s2">:</span>
    <span class="s1">root </span><span class="s2">= </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">Tk</span><span class="s2">()</span>
    <span class="s1">app </span><span class="s2">= </span><span class="s1">EventosApp</span><span class="s2">(</span><span class="s1">root</span><span class="s2">)</span>
    <span class="s1">root</span><span class="s2">.</span><span class="s1">mainloop</span><span class="s2">()</span></pre>
</body>
</html>